humhub.module("calendar.recurrence.Form",function(n,e,o){var t=e("ui.widget").Widget,r=e("client"),d=t.extend(),a="#recurrenceformmodel-frequency";d.prototype.init=function(){this.updatedValue(),this.updatedType(),this.updatedEnd();var t=this;this.options.pickerSelector&&o(this.options.pickerSelector).on("change",function(){var e=o(this),n=e.datepicker("getDate");o("#recurrenceformmodel-weekdays").val(n.getDay()+1).trigger("change"),t.updateMonthlySelection(e.val())})},d.prototype.updateMonthlySelection=function(e){r.get(this.options.updateMonthlyRecurrenceTest,{data:{date:e}}).then(function(n){if(n.result){var r=o("#recurrenceformmodel-monthdayselection");o.each(n.result,function(e,n){var t=r.find("option[value="+e+"]");t.length?t.text(n):r.append(o("<option>").attr("value",e).text(n))}),r.find("option").each(function(){var e=o(this).val();n.result[e]||o(this).remove()})}}).catch(function(e){n.log.error(e)})},d.prototype.updatedValue=function(){var e=this.$.find(a),t=parseInt(this.$.find("#recurrenceformmodel-interval").val(),10);e.find("option").each(function(){var e=o(this),n=1<t?e.data("plural"):e.data("singular");e.text(n)})},d.prototype.updatedType=function(){var e=parseInt(this.$.find(a).val(),10);-1===e?this.$.find(".hideIfNoRecurrence").addClass("d-none"):(this.$.find(".hideIfNoRecurrence").removeClass("d-none"),this.$.find("[data-recurrence-type]").addClass("d-none"),this.$.find('[data-recurrence-type="'+e+'"]').removeClass("d-none"))},d.prototype.updatedEnd=function(){switch(parseInt(this.$.find("#recurrenceformmodel-end").val(),10)){case 0:return void o(".recurrence-end-date, .recurrence-end-occurrences").hide();case 1:return o(".recurrence-end-date").removeClass("d-none"),void o(".recurrence-end-occurrences").addClass("d-none");case 2:return o(".recurrence-end-date").addClass("d-none"),void o(".recurrence-end-occurrences").removeClass("d-none")}},n.export=d});